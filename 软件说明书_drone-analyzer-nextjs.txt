软件说明书——drone-analyzer-nextjs

一、软件简介
drone-analyzer-nextjs 是一套基于 Next.js 的无人机数据分析与工作流平台，面向航拍数据采集、处理、分析、标注与报告生成等典型场景。系统整合前端可视化界面、模型管理与调用、工作流编排、交互式智能体（Agent）与协作能力，为研发、测绘、安防、巡检、农业等行业提供高效的一体化解决方案。
本系统具备如下核心能力：
1. 数据管理与展示：支持对无人机采集的图像、视频、传感器数据进行组织、检索与预览。
2. 智能分析与模型调用：集成模型管理与选择能力，可在页面内快速切换并调用目标检测、分割、分类等模型（可扩展本地或云端模型）。
3. 标注与批注：提供数据标注与审阅能力，支持协作式标注与批注记录。
4. 工作流设计：通过可视化编排，将数据处理、模型推理与结果导出等步骤串联，提升自动化与重复流程的效率。
5. 实时交互与助手：内置 Agent/Chat 模块，便于基于知识库或工具链进行问答、检索与指挥调度。
6. 管理与运维：提供角色/权限、日志与配置管理，支持多环境部署与扩展。

二、软硬件要求
1. 操作系统
- Windows 10/11（推荐）、macOS 12+、Ubuntu 20.04+/Debian 11+ 等主流系统
2. 硬件配置
- CPU：四核及以上（推荐 Intel Core i5/i7 或同级别）
- 内存：16 GB 及以上（推荐 32 GB 用于大型数据/多模型并行）
- 存储：可用空间 ≥ 2 GB（根据数据量与模型体积预留更大空间）
- GPU（可选）：如需本地推理或训练，推荐 NVIDIA 显卡（兼容 CUDA 11+），显存 8 GB 及以上
3. 运行时与依赖
- Node.js：v18 及以上
- 包管理器：npm 或 pnpm 或 yarn（任选其一）
- Python（可选）：3.9～3.11，用于本地模型或数据处理脚本
- 浏览器：Chrome/Edge/Firefox 最新版
- 其他（可选）：Git、FFmpeg、CUDA/cuDNN（若使用 GPU 本地推理）
4. 网络要求
- 可访问内部或外部模型服务、对象存储与数据库（如有）
- 如需调用第三方 AI 服务，请确保可用的 API Key 与稳定网络

三、软件主操作界面介绍
1. 登录与注册
- 入口：/login、/register
- 用途：账户登录、注册与密码找回；支持登录成功后的跳转与会话保持
2. 首页与发现
- 入口：/discover、/about
- 用途：展示平台简介、最近的项目、数据与工作流，便于快速导航与开始使用
3. 无人机数据与分析
- 入口：/drone
- 用途：集中管理与浏览无人机图像/视频/任务数据；支持预览、筛选与基础信息查看
- 可与模型推理或工作流联动，完成检测、分割、分类等分析操作
4. 标注与批注
- 入口：/annotation
- 用途：对图像/视频进行目标框、分割、多标签等标注；支持批注与协作审阅
- 可导入/导出标注数据，适配常见数据格式
5. 工作流设计
- 入口：/workflow-design
- 用途：可视化拖拽节点，编排数据预处理、模型推理、后处理与结果导出
- 支持参数配置、节点复用与流程保存，提升自动化与复现性
6. 模型管理与选择
- 入口：/model-manager、/model-selector-demo
- 用途：统一管理可用模型，查看版本、状态与性能信息；在任务中快速选择与切换模型
- 支持对接本地模型或外部推理服务，便于扩展
7. 智能体与对话
- 入口：/agent、/dify
- 用途：提供对话式交互、知识检索与指令化操作；可集成 Dify 等生态工具
- 支持在对话中触发工作流、查询数据或生成报告
8. 管理后台
- 入口：/admin
- 用途：用户与角色权限管理、系统配置、日志与状态监控；支持多环境参数设置
9. 设置与账号
- 入口：/settings、/forgot-password、/reset-password、/login-success
- 用途：个人资料、安全设置、密码管理与登录反馈
10. 文档与帮助
- 入口：/docs
- 用途：使用指南、最佳实践与迁移模板；帮助快速上手与团队协作

主控制台界面（总览）
该界面为无人机平台的综合控制与监控主页，采用网格化卡片布局，将连接、视频、分析、聊天指挥、任务与状态监测等模块集中呈现，便于单屏完成操作与态势感知。各模块说明如下：

1. 连接控制（CONNECT CONTROL）
- 位置：左上区域
- 功能：选择设备并发起连接，管理连接状态。断开或重试连接时在此操作。
- 反馈：显示当前连接状态与错误提示，连接成功后可联动视频流与分析模块。

2. 视频流（Video Stream，Streaming 面板）
- 位置：界面中央偏左的大面板
- 功能：显示无人机实时视频；在未连接时提示“Connect to drone to view stream”。
- 辅助信息：内含 Stream Info、GPS、速度、高度等基础飞行参数小卡片；底部显示连接指示与控制按钮。

3. AI分析管理器（AI Analysis Manager）
- 位置：视频流右侧大面板
- 功能：管理与触发分析任务；支持生成报告，导出为 HTML 或 PDF；显示当前分析结果或“暂无分析内容”。
- 用途：与检测控制、模型选择等模块协同，承载结果展示与报告输出。

4. 聊天与指挥面板（TTHub）
- 位置：右侧区域（AI分析管理器右侧的多卡片）
- 功能：提供对话式助手与指挥界面，支持知识检索、指令下达、任务编排触发、工具调用等。
- 场景：用于自然语言下发指令、查询数据、生成总结或报告。

5. 检测控制（DETECTION CONTROL）
- 位置：左列视频流下方
- 功能：快速触发检测工作流（例如目标检测、分割、QR识别等）；可选择不同的检测模式与参数。
- 联动：触发后结果在 AI分析管理器或视频叠加层展示。

6. 指令卡任务板（MISSIONPAD）
- 位置：检测控制下方
- 功能：用于配置与下发任务卡指令（如飞行任务、拍摄点、动作序列等），支持批量或单次任务。
- 适用：标准化任务执行、巡检流程落地。

7. 手动控制（CONTROL PANEL，虚拟遥杆）
- 位置：视频流下方中间卡片
- 功能：提供方向与动作的手动操控（如起飞、降落、左右旋转、前后左右移动），用于调试或手动介入。
- 反馈：即时响应并在状态面板显示当前动作与姿态变化。

8. 二维码扫描（QR扫描）
- 位置：手动控制面板旁
- 功能：针对二维码进行识别与解析，常用于场景标记、任务点识别或设备绑定。
- 输出：解析结果与状态提示在卡片内显示，并可推送到日志或任务流程。

9. 系统日志（System Logs）
- 位置：视频流左侧小卡片
- 功能：记录系统事件、错误与告警；便于问题定位与审计。
- 提示：在空闲或连接异常时显示“no logs available”等信息。

10. 无人机管理提醒（POSITION/状态提醒）
- 位置：底部左侧
- 功能：展示无人机位置、姿态或关键提醒信息，帮助操作者快速了解飞行状态。
- 指标：位置点、航点计数、姿态提示等。

11. 遥控状态与电池信息
- 位置：界面底部中部与右侧若干卡片
- 功能：显示遥控器连接状态、信号强度、电池电量与消耗趋势；圆形仪表盘用于直观展示电量与容量。
- 作用：保障飞行安全与任务连续性，低电量时提示预警。

12. 错误统计与任务进度
- 位置：右下区域
- 功能：展示当前系统错误数量、类别与任务进度条；支持阶段进度与总体百分比显示。
- 用途：用于快速判断系统健康度与任务执行状态。

13. 顶部导航与搜索
- 位置：页面顶部导航栏
- 功能：全局搜索、模式切换、用户头像与会话入口；支持快速跳转到管理、设置、文档等模块。
- 交互：支持消息提醒与快捷入口，提升在复杂任务中的导航效率。

14. 草莓检测统计组件
- 位置：界面右下区域左侧卡片
- 主要显示项：检测总数、成熟度分布（成熟：Ripe & Overripe；未成熟：Unripe & Partially Ripe）、当前状态提示（如“等待检测”）、时间标记。
- 功能说明：用于展示当前批次或会话中的检测结果概览。检测总数统计已识别的目标数量；成熟度分布以分区卡片方式呈现不同类别的计数，便于快速判断果园整体成熟情况。
- 交互与联动：当检测控制或工作流触发分析后，该组件自动更新计数与分类结果；支持从卡片菜单进入详细列表或历史记录。与 AI分析管理器联动时，可在报告中引用这些统计数据。
- 使用场景：巡检任务快速复盘、采摘计划评估、成熟度监测与异常分布识别。

15. 植株QR生成组件
- 位置：草莓检测统计组件右侧卡片
- 主要显示项：植株ID输入框（示例：001）、“生成QR码”按钮、生成成功后的提示与预览占位。
- 功能说明：根据输入的植株编号生成唯一识别二维码，用于现场标签打印、位置标记、数据溯源与设备绑定。
- 输入规则：植株ID应遵循项目约定格式（如三位或多位数字/字母组合）；系统可在提交前进行基本校验，避免重复或非法编号。
- 交互与联动：生成的二维码可下载或推送到任务流程；与“二维码扫描”组件协同使用，实现现场识别与数据库匹配；可将二维码绑定到分析记录，形成一株一档的完整链路。
- 使用场景：种植区资产管理、采摘批次追踪、现场快速标记与后续巡检定位。

16. PureChat 组件
- 位置：主控制台右侧聊天区域或独立页面中的聊天面板
- 核心功能：提供纯对话式交互，支持消息发送、上下文追踪、快捷指令与工具调用，面向指挥调度、知识问答、工作流触发与报告生成
- 适用场景：在巡检与分析过程中进行自然语言问答、触发分析任务、汇总结果、生成简报或导出报告

组件结构与交互
- 输入框：支持纯文本输入，可粘贴短指令或问题；回车发送或点击发送按钮
- 消息流：以时间顺序展示用户与助手消息，支持加载历史记录与继续对话
- 会话控制：可新建会话、重置上下文、切换到指定知识库或工具集合

指令与工具调用
- 快捷指令：支持诸如“开始检测”“导出报告”“查询任务状态”等自然语言命令
- 工具调用：当指令涉及数据检索、工作流执行或报告生成时，可触发相应工具链（如分析工作流、数据读取、统计汇总）
- 结果呈现：工具结果以消息形式返回，可包含结构化文本、摘要或下载链接

上下文与知识库
- 上下文维持：在同一会话中保留近期消息与关键参数，支持跨轮次引用前文信息
- 知识库接入：可绑定项目文档、操作指南或领域资料，实现基于知识的问答与指导
- 提示与澄清：当指令信息不完整时，组件会给出澄清问题或补充指引

权限与安全
- 访问控制：根据用户角色限制可调用的工具与数据范围，防止越权操作
- 敏感信息保护：API 密钥与凭证通过环境变量或安全存储管理，聊天记录中的敏感字段可脱敏展示
- 日志记录：重要指令与工具调用会写入系统日志，便于审计与问题追踪

错误与边界处理
- 连接异常：当后端服务不可用或网络不稳定时，给出错误提示与重试建议
- 工具失败：工具执行失败会返回原因与修复建议，如依赖缺失、参数不合法、资源未找到
- 超时与终止：长时任务支持超时提示与取消操作，避免阻塞会话

联动能力
- 与 AI 分析管理器联动：可在对话中触发分析并将结果同步到分析管理面板
- 与工作流设计联动：对话中创建或调用既有工作流模板，实现自动化批处理
- 与二维码与检测模块联动：通过对话生成二维码、查询检测统计或定位特定植株数据

使用建议
- 将重要操作以简短明确的指令下达，如“对当前视频帧进行目标检测并输出统计”
- 在复杂任务中先确认上下文参数（数据源、模型版本、输出格式），再触发工具调用
- 定期清理或归档会话，确保上下文不混淆并提升响应准确性

界面使用建议
- 先在“连接控制”完成设备连接，再打开“视频流”确认画面与参数正常。
- 按需在“检测控制”选择工作流并在“AI分析管理器”查看与导出结果。
- 使用“聊天与指挥面板”下达自然语言指令或生成任务报告，必要时切入“手动控制”微调机位。
- 密切关注“系统日志”“电池与遥控状态”“错误统计与任务进度”，确保操作安全与任务闭环。

四、典型使用流程（示例）
1. 登录系统后，在“drone”页面导入或浏览无人机数据
2. 在“model-manager”确认可用模型，并在任务中通过“model-selector”选择模型
3. 在“annotation”进行数据标注与审阅，形成高质量数据集
4. 在“workflow-design”编排分析流程，串联预处理、推理与导出节点
5. 在“agent”或“dify”中进行对话式分析、检索与报告生成
6. 在“admin/设置”中进行权限、参数与系统维护

五、部署与运行（简要）
1. 前提条件：安装 Node.js v18+ 与包管理器；如需本地模型，准备 Python 环境与相关依赖
2. 安装依赖：在项目目录执行安装命令（如 npm install 或 pnpm install）
3. 开发运行：执行开发命令启动本地服务（如 npm run dev）
4. 生产部署：构建产物（如 npm run build）并启动（如 npm run start）；按需配置反向代理与 SSL
5. 环境变量：根据需要设置模型服务地址、存储与鉴权等秘钥参数（请勿在日志中泄露）

六、安全与合规
1. 访问控制：启用账号与角色权限，限制敏感操作
2. 数据安全：敏感信息与密钥使用环境变量管理，避免明文写入代码库
3. 日志与隐私：遵守数据最小化与合规要求，按需脱敏与存储

七、维护与支持
1. 问题排查：优先查看浏览器控制台与服务端日志；确认依赖与环境变量
2. 常见问题：端口占用、模型服务未连通、依赖版本冲突、GPU 驱动/库不匹配
3. 升级建议：在测试环境验证后再升级生产；记录变更与回滚方案

说明
本说明书为 drone-analyzer-nextjs 项目的通用使用说明。实际功能与入口名称以当前部署版本为准；如需定制功能或集成外部服务，请联系项目维护者进行扩展与配置。
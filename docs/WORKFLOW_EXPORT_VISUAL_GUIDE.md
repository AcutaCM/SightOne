# 工作流导出 - 可视化指南

## 📸 界面预览

### 导出按钮位置

```
┌─────────────────────────────────────────────────────────────┐
│                     工作流编辑器                              │
├──────────┬────────────────────────────────────┬─────────────┤
│          │                                    │             │
│  节点库  │         工作流画布                  │  控制面板   │
│          │                                    │             │
│          │  ┌──────────────────────────┐     │             │
│          │  │                          │     │             │
│          │  │   [工具栏]  [导出按钮]   │     │             │
│          │  │      ↑         ↑         │     │             │
│          │  │   缩放控制   导出功能     │     │             │
│          │  │                          │     │             │
│          │  │   ┌────┐    ┌────┐      │     │             │
│          │  │   │节点│───▶│节点│      │     │             │
│          │  │   └────┘    └────┘      │     │             │
│          │  │                          │     │             │
│          │  └──────────────────────────┘     │             │
└──────────┴────────────────────────────────────┴─────────────┘
```

### 导出按钮样式

#### 工具栏模式 (图标)
```
┌─────────────────────────────────────┐
│  [−] [100%] [+]  │  [⊡] [↻]  │  [↓] │
│   缩小 比例 放大     适应 重置    导出 │
└─────────────────────────────────────┘
```

#### 独立模式 (带文字)
```
┌──────────────┐
│  ↓  导出  ▼  │
└──────────────┘
```

## 🎨 导出菜单

### 菜单结构

```
┌─────────────────────────────┐
│  导出全部节点                │
│  ┌─────────────────────────┐│
│  │ 🖼️  PNG 图片            ││
│  └─────────────────────────┘│
│  ┌─────────────────────────┐│
│  │ 📐  SVG 矢量图          ││
│  └─────────────────────────┘│
│  ─────────────────────────  │
│  仅导出选中节点              │
│  ┌─────────────────────────┐│
│  │ 🖼️  PNG 图片 (选中)    ││
│  └─────────────────────────┘│
│  ┌─────────────────────────┐│
│  │ 📐  SVG 矢量图 (选中)  ││
│  └─────────────────────────┘│
└─────────────────────────────┘
```

### 菜单交互

#### 1. 悬停效果
```
正常状态:
┌─────────────────────────┐
│ 🖼️  PNG 图片            │
└─────────────────────────┘

悬停状态:
┌─────────────────────────┐
│ 🖼️  PNG 图片  →         │  ← 高亮 + 右移
└─────────────────────────┘
```

#### 2. 点击反馈
```
点击前:
┌──────────────┐
│  ↓  导出  ▼  │
└──────────────┘

点击后 (加载中):
┌──────────────┐
│  ⟳  导出     │  ← 旋转动画
└──────────────┘
```

## 🎯 使用流程

### 流程 1: 导出全部节点

```
1. 点击导出按钮
   ┌──────────────┐
   │  ↓  导出  ▼  │ ← 点击
   └──────────────┘

2. 菜单展开
   ┌─────────────────────────────┐
   │  导出全部节点                │
   │  ┌─────────────────────────┐│
   │  │ 🖼️  PNG 图片            ││ ← 选择
   │  └─────────────────────────┘│
   └─────────────────────────────┘

3. 导出中
   ┌──────────────┐
   │  ⟳  导出     │ ← 加载动画
   └──────────────┘

4. 导出完成
   ┌─────────────────────────────┐
   │  ✅ 导出成功!                │ ← 提示消息
   └─────────────────────────────┘
   
5. 文件下载
   📥 workflow-1730172000000.png
```

### 流程 2: 导出选中节点

```
1. 选中节点
   ┌────────────────────────┐
   │  ┌────┐    ┌────┐      │
   │  │节点│───▶│节点│      │
   │  └────┘    └────┘      │
   │    ↑         ↑          │
   │   选中      选中         │
   └────────────────────────┘

2. 点击导出按钮
   ┌──────────────┐
   │  ↓  导出  ▼  │ ← 点击
   └──────────────┘

3. 选择 "仅导出选中"
   ┌─────────────────────────────┐
   │  仅导出选中节点              │
   │  ┌─────────────────────────┐│
   │  │ 🖼️  PNG 图片 (选中)    ││ ← 选择
   │  └─────────────────────────┘│
   └─────────────────────────────┘

4. 导出完成
   📥 workflow-1730172000000.png
   (仅包含选中的节点)
```

## 🎨 主题适配

### 明亮主题

```
┌─────────────────────────────┐
│  导出全部节点                │  ← 浅灰色背景
│  ┌─────────────────────────┐│
│  │ 🖼️  PNG 图片            ││  ← 深色文字
│  └─────────────────────────┘│
└─────────────────────────────┘

导出效果:
┌────────────────────────┐
│  ┌────┐    ┌────┐      │
│  │节点│───▶│节点│      │  ← 浅色背景 (#f8fafc)
│  └────┘    └────┘      │
└────────────────────────┘
```

### 暗黑主题

```
┌─────────────────────────────┐
│  导出全部节点                │  ← 深色背景
│  ┌─────────────────────────┐│
│  │ 🖼️  PNG 图片            ││  ← 浅色文字
│  └─────────────────────────┘│
└─────────────────────────────┘

导出效果:
┌────────────────────────┐
│  ┌────┐    ┌────┐      │
│  │节点│───▶│节点│      │  ← 深色背景 (#0a0f1e)
│  └────┘    └────┘      │
└────────────────────────┘
```

## 📊 导出质量对比

### PNG vs SVG

```
PNG 图片:
┌────────────────────────┐
│  ████████████████████  │
│  ████████████████████  │  ← 位图,固定分辨率
│  ████████████████████  │     文件较大
│  ████████████████████  │
└────────────────────────┘

SVG 矢量图:
┌────────────────────────┐
│  <svg>                 │
│    <rect />            │  ← 矢量,可缩放
│    <path />            │     文件较小
│  </svg>                │
└────────────────────────┘
```

### 分辨率对比

```
标准分辨率 (1x):
┌──────┐
│ 节点 │  ← 100x50 像素
└──────┘

高分辨率 (2x):
┌────────────┐
│   节点     │  ← 200x100 像素
└────────────┘  (更清晰)
```

## 🔍 导出边界

### 自动计算边界

```
原始工作流:
┌────────────────────────────────┐
│                                │
│    ┌────┐    ┌────┐           │
│    │节点│───▶│节点│           │
│    └────┘    └────┘           │
│                                │
│         ┌────┐                │
│         │节点│                │
│         └────┘                │
│                                │
└────────────────────────────────┘

导出边界 (带内边距):
    ┌──────────────────────┐
    │  padding: 40px       │
    │  ┌────┐    ┌────┐   │
    │  │节点│───▶│节点│   │
    │  └────┘    └────┘   │
    │                      │
    │       ┌────┐        │
    │       │节点│        │
    │       └────┘        │
    │                      │
    └──────────────────────┘
```

### 选中节点边界

```
全部节点:
┌────────────────────────────────┐
│  ┌────┐    ┌────┐    ┌────┐   │
│  │节点│───▶│节点│───▶│节点│   │
│  └────┘    └────┘    └────┘   │
└────────────────────────────────┘

仅选中节点:
    ┌──────────────────┐
    │  ┌────┐    ┌────┐│
    │  │节点│───▶│节点││  ← 只导出选中部分
    │  └────┘    └────┘│
    └──────────────────┘
```

## ⚠️ 错误提示

### 错误消息样式

```
┌─────────────────────────────────┐
│  ⚠️  工作流中没有节点            │  ← 红色背景
└─────────────────────────────────┘
    ↓ 3秒后自动消失

┌─────────────────────────────────┐
│  ⚠️  请先选择要导出的节点        │  ← 红色背景
└─────────────────────────────────┘
```

### 错误位置

```
┌─────────────────────────────────────────────────────────────┐
│                     工作流编辑器                              │
│                                                               │
│                                                               │
│                                                               │
│                                                               │
│                                                               │
│                                                               │
│                                                               │
│                                                               │
│                                                               │
│                                    ┌─────────────────────┐   │
│                                    │ ⚠️  导出失败        │   │
│                                    └─────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                                            ↑
                                      右下角提示
```

## 🎬 动画效果

### 菜单展开动画

```
帧 1 (0ms):
┌──────────────┐
│  ↓  导出  ▼  │
└──────────────┘

帧 2 (50ms):
┌──────────────┐
│  ↓  导出  ▼  │
└──────────────┘
┌─────────────┐  ← 开始展开
│             │     (透明度 0 → 1)
└─────────────┘     (位移 -8px → 0)

帧 3 (150ms):
┌──────────────┐
│  ↓  导出  ▼  │
└──────────────┘
┌─────────────────────────────┐
│  导出全部节点                │  ← 完全展开
│  ┌─────────────────────────┐│
│  │ 🖼️  PNG 图片            ││
│  └─────────────────────────┘│
└─────────────────────────────┘
```

### 加载动画

```
帧 1:        帧 2:        帧 3:        帧 4:
┌────┐      ┌────┐      ┌────┐      ┌────┐
│ ⟳  │  →   │  ⟳ │  →   │   ⟳│  →   │⟳   │
└────┘      └────┘      └────┘      └────┘
  0°          90°         180°        270°
```

## 📱 响应式设计

### 桌面端 (>1024px)

```
┌─────────────────────────────────────────────────────────────┐
│  [工具栏]                                        [导出按钮]  │
│                                                               │
│                     工作流画布                                │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

### 平板端 (768px-1024px)

```
┌───────────────────────────────────────────────┐
│  [工具栏]                        [导出按钮]   │
│                                               │
│              工作流画布                        │
│                                               │
└───────────────────────────────────────────────┘
```

### 移动端 (<768px)

```
┌─────────────────────────────┐
│  [工具栏]        [导出按钮] │
│                             │
│       工作流画布             │
│                             │
└─────────────────────────────┘

导出菜单 (全宽):
┌─────────────────────────────┐
│  导出全部节点                │
│  ┌─────────────────────────┐│
│  │ 🖼️  PNG 图片            ││
│  └─────────────────────────┘│
└─────────────────────────────┘
```

## 🎨 颜色方案

### 明亮主题颜色

```
背景色:     #ffffff  ████
边框色:     #e2e8f0  ████
文字色:     #0f172a  ████
悬停色:     #f1f5f9  ████
主色调:     #3b82f6  ████
```

### 暗黑主题颜色

```
背景色:     #111827  ████
边框色:     #1f2937  ████
文字色:     #f1f5f9  ████
悬停色:     #1f2937  ████
主色调:     #3b82f6  ████
```

## 📐 尺寸规范

### 按钮尺寸

```
工具栏按钮:
┌────────────┐
│  20x20 图标 │  高度: 36px
│            │  内边距: 8x12px
└────────────┘

独立按钮:
┌──────────────────┐
│  20x20 图标 文字  │  高度: 40px
│                  │  内边距: 10x16px
└──────────────────┘
```

### 菜单尺寸

```
┌─────────────────────────────┐
│  最小宽度: 220px             │
│  内边距: 8px                 │
│  ┌─────────────────────────┐│
│  │ 菜单项高度: 40px         ││
│  │ 内边距: 10x12px          ││
│  └─────────────────────────┘│
└─────────────────────────────┘
```

## 🔧 技术细节

### 导出流程图

```
开始
  ↓
获取节点
  ↓
过滤节点 (如果选中模式)
  ↓
计算边界
  ↓
获取视口元素
  ↓
渲染为图片
  ↓
下载文件
  ↓
结束
```

### 组件层次

```
ExportButton
├── Button (触发器)
│   ├── Icon (图标)
│   ├── Text (文字)
│   └── Chevron (箭头)
├── Menu (菜单)
│   ├── Section (全部节点)
│   │   ├── MenuItem (PNG)
│   │   └── MenuItem (SVG)
│   ├── Divider (分隔线)
│   └── Section (选中节点)
│       ├── MenuItem (PNG)
│       └── MenuItem (SVG)
└── ErrorToast (错误提示)
```

## 📚 相关资源

- [完整导出指南](./WORKFLOW_EXPORT_GUIDE.md)
- [快速开始](./WORKFLOW_EXPORT_QUICK_START.md)
- [工作流编辑器](./WORKFLOW_QUICK_START.md)
- [主题系统](./WORKFLOW_THEME_SYSTEM_IMPLEMENTATION.md)

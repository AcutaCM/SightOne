# WebSocketçŠ¶æ€è®¢é˜… - å¯è§†åŒ–æŒ‡å—

## ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯åº”ç”¨ (Next.js)                                â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    WebSocketå®¢æˆ·ç«¯                            â”‚  â”‚
â”‚  â”‚                 (è¿æ¥åˆ°3004ç«¯å£)                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ WebSocket
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ™ºèƒ½ä»£ç†åç«¯ (3004ç«¯å£)                                  â”‚
â”‚              tello_agent_backend.py                                 â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              WebSocketæœåŠ¡å™¨                                  â”‚  â”‚
â”‚  â”‚              - æ¥æ”¶å‰ç«¯å‘½ä»¤                                    â”‚  â”‚
â”‚  â”‚              - å¹¿æ’­çŠ¶æ€æ›´æ–°                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              BridgeClient                                     â”‚  â”‚
â”‚  â”‚              bridge_client.py                                 â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  subscribe_status_updates()                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - å¯åŠ¨WebSocketè®¢é˜…                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - æ³¨å†Œå›è°ƒå‡½æ•°                                        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                              â”‚                                â”‚  â”‚
â”‚  â”‚                              â–¼                                â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  _websocket_status_loop()                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - å»ºç«‹WebSocketè¿æ¥                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - æ¥æ”¶çŠ¶æ€æ¶ˆæ¯                                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - è§£æå’ŒéªŒè¯                                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - è‡ªåŠ¨é‡è¿                                            â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                              â”‚                                â”‚  â”‚
â”‚  â”‚                              â–¼                                â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  _validate_status_message()                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - éªŒè¯æ¶ˆæ¯æ ¼å¼                                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - æ£€æŸ¥å¿…éœ€å­—æ®µ                                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - æ•°æ®ç±»å‹éªŒè¯                                        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              StatusManager                                    â”‚  â”‚
â”‚  â”‚              status_manager.py                                â”‚  â”‚
â”‚  â”‚              - æ›´æ–°çŠ¶æ€                                        â”‚  â”‚
â”‚  â”‚              - æ£€æµ‹å˜åŒ–                                        â”‚  â”‚
â”‚  â”‚              - å¹¿æ’­æ›´æ–°                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ WebSocket
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ— äººæœºæ§åˆ¶åç«¯ (3002ç«¯å£)                                â”‚
â”‚              drone_backend.py                                       â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              WebSocketæœåŠ¡å™¨                                  â”‚  â”‚
â”‚  â”‚              - æ¨é€çŠ¶æ€æ›´æ–°                                    â”‚  â”‚
â”‚  â”‚              - å¤„ç†è®¢é˜…è¯·æ±‚                                    â”‚  â”‚
â”‚  â”‚              - å¹¿æ’­çŠ¶æ€å˜åŒ–                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Telloæ— äººæœºæ§åˆ¶                                   â”‚  â”‚
â”‚  â”‚              - è·å–æ— äººæœºçŠ¶æ€                                  â”‚  â”‚
â”‚  â”‚              - æ‰§è¡Œé£è¡Œå‘½ä»¤                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ¶ˆæ¯æµç¨‹å›¾

### 1. è¿æ¥å»ºç«‹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3004    â”‚                    â”‚  3002    â”‚                    â”‚  Tello   â”‚
â”‚  æ™ºèƒ½    â”‚                    â”‚  æ§åˆ¶    â”‚                    â”‚  æ— äººæœº  â”‚
â”‚  ä»£ç†    â”‚                    â”‚  åç«¯    â”‚                    â”‚          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                               â”‚                               â”‚
     â”‚  1. HTTPè¿æ¥                  â”‚                               â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                               â”‚
     â”‚                               â”‚                               â”‚
     â”‚  2. å¥åº·æ£€æŸ¥                  â”‚                               â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                               â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
     â”‚  3. è¿æ¥æˆåŠŸ                  â”‚                               â”‚
     â”‚                               â”‚                               â”‚
     â”‚  4. WebSocketè¿æ¥è¯·æ±‚         â”‚                               â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                               â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
     â”‚  5. è¿æ¥ç¡®è®¤                  â”‚                               â”‚
     â”‚                               â”‚                               â”‚
     â”‚  6. è®¢é˜…è¯·æ±‚                  â”‚                               â”‚
     â”‚  {"type": "subscribe"}        â”‚                               â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                               â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
     â”‚  7. è®¢é˜…ç¡®è®¤                  â”‚                               â”‚
     â”‚                               â”‚                               â”‚
```

### 2. çŠ¶æ€æ›´æ–°æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3004    â”‚                    â”‚  3002    â”‚                    â”‚  Tello   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                               â”‚                               â”‚
     â”‚                               â”‚  1. æŸ¥è¯¢çŠ¶æ€                  â”‚
     â”‚                               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                               â”‚  2. è¿”å›çŠ¶æ€                  â”‚
     â”‚                               â”‚  (battery: 85%, ...)          â”‚
     â”‚                               â”‚                               â”‚
     â”‚  3. æ¨é€çŠ¶æ€æ›´æ–°              â”‚                               â”‚
     â”‚  {"type": "status_update"}    â”‚                               â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
     â”‚                               â”‚                               â”‚
     â”‚  4. éªŒè¯æ¶ˆæ¯                  â”‚                               â”‚
     â”‚  _validate_status_message()   â”‚                               â”‚
     â”‚                               â”‚                               â”‚
     â”‚  5. è°ƒç”¨å›è°ƒ                  â”‚                               â”‚
     â”‚  status_callback(data)        â”‚                               â”‚
     â”‚                               â”‚                               â”‚
     â”‚  6. æ›´æ–°æœ¬åœ°çŠ¶æ€              â”‚                               â”‚
     â”‚  update_drone_status()        â”‚                               â”‚
     â”‚                               â”‚                               â”‚
     â”‚  7. å¹¿æ’­ç»™å‰ç«¯                â”‚                               â”‚
     â”‚  broadcast_status()           â”‚                               â”‚
     â”‚                               â”‚                               â”‚
```

### 3. å¿ƒè·³ä¿æ´»æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3004    â”‚                    â”‚  3002    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                               â”‚
     â”‚  æ¯30ç§’                       â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
     â”‚  â”‚ å¿ƒè·³å®šæ—¶å™¨è§¦å‘      â”‚     â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
     â”‚                               â”‚
     â”‚  1. å‘é€å¿ƒè·³                  â”‚
     â”‚  {"type": "ping"}             â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                               â”‚
     â”‚                               â”‚  å¤„ç†å¿ƒè·³
     â”‚                               â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚  2. å¿ƒè·³å“åº”                  â”‚
     â”‚  {"type": "pong"}             â”‚
     â”‚                               â”‚
     â”‚  âœ… è¿æ¥æ­£å¸¸                  â”‚
     â”‚                               â”‚
```

### 4. æ–­çº¿é‡è¿æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3004    â”‚                    â”‚  3002    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                               â”‚
     â”‚  æ­£å¸¸é€šä¿¡                     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                               â”‚
     â”‚                               âœ— è¿æ¥æ–­å¼€
     â”‚                               â”‚
     â”‚  âŒ æ£€æµ‹åˆ°æ–­å¼€                â”‚
     â”‚                               â”‚
     â”‚  ç­‰å¾… 2ç§’                     â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
     â”‚  â”‚ é‡è¿å°è¯• 1/5        â”‚     â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
     â”‚                               â”‚
     â”‚  1. é‡è¿è¯·æ±‚                  â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚  âŒ å¤±è´¥                      â”‚
     â”‚                               â”‚
     â”‚  ç­‰å¾… 3ç§’ (2 * 1.5)           â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
     â”‚  â”‚ é‡è¿å°è¯• 2/5        â”‚     â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
     â”‚                               â”‚
     â”‚  2. é‡è¿è¯·æ±‚                  â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚  âœ… æˆåŠŸ                      â”‚
     â”‚                               â”‚
     â”‚  3. é‡æ–°è®¢é˜…                  â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                               â”‚
     â”‚  âœ… æ¢å¤æ­£å¸¸é€šä¿¡              â”‚
     â”‚                               â”‚
```

## æ¶ˆæ¯æ ¼å¼ç¤ºä¾‹

### çŠ¶æ€æ›´æ–°æ¶ˆæ¯

```json
{
  "type": "status_update",
  "data": {
    "connected": true,
    "flying": false,
    "battery": 85,
    "temperature": 25,
    "height": 0,
    "speed": {
      "x": 0,
      "y": 0,
      "z": 0
    },
    "position": {
      "x": 0,
      "y": 0,
      "z": 0
    },
    "wifi_signal": 90,
    "flight_time": 0
  }
}
```

### å¿ƒè·³æ¶ˆæ¯

```json
{
  "type": "ping",
  "timestamp": 1699999999.999
}
```

### é”™è¯¯æ¶ˆæ¯

```json
{
  "type": "error",
  "message": "æ— äººæœºè¿æ¥å¤±è´¥",
  "code": "DRONE_CONNECTION_ERROR"
}
```

## çŠ¶æ€æœºå›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  DISCONNECTED   â”‚
                    â”‚  (åˆå§‹çŠ¶æ€)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ connect()
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   CONNECTING    â”‚
                    â”‚  (è¿æ¥ä¸­)        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚
            æˆåŠŸ    â”‚                 â”‚  å¤±è´¥
                    â–¼                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   CONNECTED     â”‚  â”‚     ERROR       â”‚
         â”‚  (å·²è¿æ¥)        â”‚  â”‚   (é”™è¯¯)         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                    â”‚
                  â”‚                    â”‚ reconnect()
                  â”‚                    â–¼
                  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚           â”‚  RECONNECTING   â”‚
                  â”‚           â”‚  (é‡è¿ä¸­)        â”‚
                  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                    â”‚
                  â”‚                    â”‚ æˆåŠŸ
                  â”‚                    â–¼
                  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚   CONNECTED     â”‚
                              â”‚  (å·²è¿æ¥)        â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ disconnect()
                                       â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  DISCONNECTED   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä»£ç æ‰§è¡Œæµç¨‹

### è®¢é˜…å¯åŠ¨æµç¨‹

```python
# 1. åˆ›å»ºæ¡¥æ¥å®¢æˆ·ç«¯
bridge = BridgeClient(config)

# 2. è¿æ¥åˆ°æ— äººæœºæ§åˆ¶åç«¯
await bridge.connect()
    â”œâ”€> åˆ›å»ºHTTPä¼šè¯
    â”œâ”€> æ‰§è¡Œå¥åº·æ£€æŸ¥
    â””â”€> å¯åŠ¨å¥åº·æ£€æŸ¥å¾ªç¯

# 3. è®¢é˜…çŠ¶æ€æ›´æ–°
await bridge.subscribe_status_updates(callback)
    â”œâ”€> ä¿å­˜å›è°ƒå‡½æ•°
    â””â”€> å¯åŠ¨WebSocketä»»åŠ¡
        â””â”€> _websocket_status_loop()

# 4. WebSocketå¾ªç¯
while reconnect_attempts < max_attempts:
    â”œâ”€> å»ºç«‹WebSocketè¿æ¥
    â”œâ”€> å‘é€è®¢é˜…è¯·æ±‚
    â”œâ”€> å¯åŠ¨å¿ƒè·³ä»»åŠ¡
    â””â”€> æ¥æ”¶æ¶ˆæ¯å¾ªç¯
        â”œâ”€> è§£æJSON
        â”œâ”€> éªŒè¯æ¶ˆæ¯
        â”œâ”€> è·¯ç”±æ¶ˆæ¯ç±»å‹
        â””â”€> è°ƒç”¨å›è°ƒ
```

### æ¶ˆæ¯å¤„ç†æµç¨‹

```python
# æ¥æ”¶åˆ°æ¶ˆæ¯
async for msg in ws:
    if msg.type == WSMsgType.TEXT:
        # 1. è§£æJSON
        data = json.loads(msg.data)
        
        # 2. éªŒè¯æ¶ˆæ¯
        if not _validate_status_message(data):
            continue
        
        # 3. è·¯ç”±æ¶ˆæ¯ç±»å‹
        msg_type = data.get("type")
        
        if msg_type == "status_update":
            # 4. æå–çŠ¶æ€æ•°æ®
            status_data = data.get("data", {})
            
            # 5. è°ƒç”¨å›è°ƒ
            await status_callback(status_data)
                â”œâ”€> æ›´æ–°æœ¬åœ°çŠ¶æ€
                â”œâ”€> æ›´æ–°çŠ¶æ€ç®¡ç†å™¨
                â””â”€> å¹¿æ’­ç»™å‰ç«¯
```

## é…ç½®å‚æ•°å½±å“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é…ç½®å‚æ•°                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ws_heartbeat_interval = 30.0                          â”‚
â”‚  â”œâ”€> å¿ƒè·³é—´éš”: æ¯30ç§’å‘é€ä¸€æ¬¡ping                      â”‚
â”‚  â””â”€> å½±å“: è¿æ¥ä¿æ´»é¢‘ç‡                                â”‚
â”‚                                                         â”‚
â”‚  max_reconnect_attempts = 5                            â”‚
â”‚  â”œâ”€> æœ€å¤§é‡è¿æ¬¡æ•°: 5æ¬¡                                 â”‚
â”‚  â””â”€> å½±å“: é‡è¿å¤±è´¥å‰çš„å°è¯•æ¬¡æ•°                        â”‚
â”‚                                                         â”‚
â”‚  reconnect_delay = 2.0                                 â”‚
â”‚  â”œâ”€> åˆå§‹é‡è¿å»¶è¿Ÿ: 2ç§’                                 â”‚
â”‚  â””â”€> å½±å“: ç¬¬ä¸€æ¬¡é‡è¿çš„ç­‰å¾…æ—¶é—´                        â”‚
â”‚                                                         â”‚
â”‚  reconnect_backoff = 1.5                               â”‚
â”‚  â”œâ”€> é€€é¿å› å­: 1.5å€                                   â”‚
â”‚  â””â”€> å½±å“: é‡è¿å»¶è¿Ÿå¢é•¿é€Ÿåº¦                            â”‚
â”‚      ç¬¬1æ¬¡: 2ç§’                                         â”‚
â”‚      ç¬¬2æ¬¡: 3ç§’ (2 * 1.5)                              â”‚
â”‚      ç¬¬3æ¬¡: 4.5ç§’ (3 * 1.5)                            â”‚
â”‚      ç¬¬4æ¬¡: 6.75ç§’ (4.5 * 1.5)                         â”‚
â”‚      ç¬¬5æ¬¡: 10.125ç§’ (6.75 * 1.5)                      â”‚
â”‚                                                         â”‚
â”‚  max_reconnect_delay = 30.0                            â”‚
â”‚  â”œâ”€> æœ€å¤§é‡è¿å»¶è¿Ÿ: 30ç§’                                â”‚
â”‚  â””â”€> å½±å“: é‡è¿å»¶è¿Ÿä¸Šé™                                â”‚
â”‚                                                         â”‚
â”‚  connection_timeout = 10.0                             â”‚
â”‚  â”œâ”€> è¿æ¥è¶…æ—¶: 10ç§’                                    â”‚
â”‚  â””â”€> å½±å“: è¿æ¥å»ºç«‹çš„æœ€é•¿ç­‰å¾…æ—¶é—´                      â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ€§èƒ½æŒ‡æ ‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ€§èƒ½æŒ‡æ ‡                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  è¿æ¥å»ºç«‹æ—¶é—´                                           â”‚
â”‚  â”œâ”€> æ­£å¸¸æƒ…å†µ: < 1ç§’                                    â”‚
â”‚  â””â”€> ç½‘ç»œå»¶è¿Ÿ: 1-3ç§’                                    â”‚
â”‚                                                         â”‚
â”‚  æ¶ˆæ¯å»¶è¿Ÿ                                               â”‚
â”‚  â”œâ”€> æœ¬åœ°ç½‘ç»œ: < 10ms                                   â”‚
â”‚  â”œâ”€> å±€åŸŸç½‘: < 50ms                                     â”‚
â”‚  â””â”€> äº’è”ç½‘: 50-200ms                                   â”‚
â”‚                                                         â”‚
â”‚  æ¶ˆæ¯å¤„ç†é€Ÿåº¦                                           â”‚
â”‚  â”œâ”€> è§£æ: < 1ms                                        â”‚
â”‚  â”œâ”€> éªŒè¯: < 1ms                                        â”‚
â”‚  â””â”€> å›è°ƒ: < 10ms                                       â”‚
â”‚                                                         â”‚
â”‚  å¿ƒè·³å¼€é”€                                               â”‚
â”‚  â”œâ”€> æ¶ˆæ¯å¤§å°: ~50å­—èŠ‚                                  â”‚
â”‚  â”œâ”€> é¢‘ç‡: æ¯30ç§’                                       â”‚
â”‚  â””â”€> å¸¦å®½: ~1.7å­—èŠ‚/ç§’                                  â”‚
â”‚                                                         â”‚
â”‚  é‡è¿æ—¶é—´                                               â”‚
â”‚  â”œâ”€> ç¬¬1æ¬¡: 2ç§’                                         â”‚
â”‚  â”œâ”€> ç¬¬2æ¬¡: 3ç§’                                         â”‚
â”‚  â”œâ”€> ç¬¬3æ¬¡: 4.5ç§’                                       â”‚
â”‚  â””â”€> æ€»è®¡: ~10ç§’ (å‰3æ¬¡)                                â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## é”™è¯¯å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é”™è¯¯ç±»å‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  1. è¿æ¥é”™è¯¯                                            â”‚
â”‚     â”œâ”€> æ£€æµ‹: è¿æ¥è¶…æ—¶ã€æ‹’ç»è¿æ¥                       â”‚
â”‚     â”œâ”€> å¤„ç†: è®°å½•æ—¥å¿—ã€è§¦å‘é‡è¿                       â”‚
â”‚     â””â”€> æ¢å¤: è‡ªåŠ¨é‡è¿                                  â”‚
â”‚                                                         â”‚
â”‚  2. JSONè§£æé”™è¯¯                                        â”‚
â”‚     â”œâ”€> æ£€æµ‹: json.JSONDecodeError                     â”‚
â”‚     â”œâ”€> å¤„ç†: è®°å½•é”™è¯¯æ¶ˆæ¯ã€è·³è¿‡è¯¥æ¶ˆæ¯                 â”‚
â”‚     â””â”€> æ¢å¤: ç»§ç»­æ¥æ”¶ä¸‹ä¸€æ¡æ¶ˆæ¯                       â”‚
â”‚                                                         â”‚
â”‚  3. æ¶ˆæ¯éªŒè¯é”™è¯¯                                        â”‚
â”‚     â”œâ”€> æ£€æµ‹: _validate_status_message() è¿”å›False    â”‚
â”‚     â”œâ”€> å¤„ç†: è®°å½•è­¦å‘Šã€è·³è¿‡è¯¥æ¶ˆæ¯                     â”‚
â”‚     â””â”€> æ¢å¤: ç»§ç»­æ¥æ”¶ä¸‹ä¸€æ¡æ¶ˆæ¯                       â”‚
â”‚                                                         â”‚
â”‚  4. å›è°ƒæ‰§è¡Œé”™è¯¯                                        â”‚
â”‚     â”œâ”€> æ£€æµ‹: å›è°ƒå‡½æ•°æŠ›å‡ºå¼‚å¸¸                         â”‚
â”‚     â”œâ”€> å¤„ç†: æ•è·å¼‚å¸¸ã€è®°å½•é”™è¯¯                       â”‚
â”‚     â””â”€> æ¢å¤: ç»§ç»­æ¥æ”¶ä¸‹ä¸€æ¡æ¶ˆæ¯                       â”‚
â”‚                                                         â”‚
â”‚  5. WebSocketå…³é—­                                       â”‚
â”‚     â”œâ”€> æ£€æµ‹: WSMsgType.CLOSED                         â”‚
â”‚     â”œâ”€> å¤„ç†: æ¸…ç†èµ„æºã€è®°å½•æ—¥å¿—                       â”‚
â”‚     â””â”€> æ¢å¤: è§¦å‘é‡è¿                                  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯1: å®æ—¶ç›‘æ§æ— äººæœºçŠ¶æ€

```python
# åˆ›å»ºçŠ¶æ€ç›‘æ§å™¨
class DroneMonitor:
    def __init__(self):
        self.battery_history = []
        self.height_history = []
    
    async def status_callback(self, status):
        # è®°å½•ç”µæ± å†å²
        battery = status.get('battery')
        self.battery_history.append(battery)
        
        # æ£€æŸ¥ä½ç”µé‡
        if battery < 20:
            print(f"âš ï¸ è­¦å‘Š: ç”µæ± ç”µé‡ä½ ({battery}%)")
        
        # è®°å½•é«˜åº¦å†å²
        height = status.get('height')
        self.height_history.append(height)
        
        # æ£€æŸ¥é«˜åº¦é™åˆ¶
        if height > 300:
            print(f"âš ï¸ è­¦å‘Š: é«˜åº¦è¶…é™ ({height}cm)")

# ä½¿ç”¨ç›‘æ§å™¨
monitor = DroneMonitor()
await bridge.subscribe_status_updates(monitor.status_callback)
```

### åœºæ™¯2: çŠ¶æ€å˜åŒ–é€šçŸ¥

```python
# åˆ›å»ºçŠ¶æ€å˜åŒ–æ£€æµ‹å™¨
class StatusChangeDetector:
    def __init__(self):
        self.last_status = {}
    
    async def status_callback(self, status):
        # æ£€æµ‹è¿æ¥çŠ¶æ€å˜åŒ–
        if status.get('connected') != self.last_status.get('connected'):
            if status.get('connected'):
                print("âœ… æ— äººæœºå·²è¿æ¥")
            else:
                print("âŒ æ— äººæœºå·²æ–­å¼€")
        
        # æ£€æµ‹é£è¡ŒçŠ¶æ€å˜åŒ–
        if status.get('flying') != self.last_status.get('flying'):
            if status.get('flying'):
                print("ğŸš æ— äººæœºèµ·é£")
            else:
                print("ğŸ›¬ æ— äººæœºé™è½")
        
        # æ›´æ–°ä¸Šæ¬¡çŠ¶æ€
        self.last_status = status.copy()

# ä½¿ç”¨æ£€æµ‹å™¨
detector = StatusChangeDetector()
await bridge.subscribe_status_updates(detector.status_callback)
```

### åœºæ™¯3: æ•°æ®è®°å½•å’Œåˆ†æ

```python
# åˆ›å»ºæ•°æ®è®°å½•å™¨
class DataLogger:
    def __init__(self, filename):
        self.filename = filename
        self.file = open(filename, 'a')
    
    async def status_callback(self, status):
        # è®°å½•æ—¶é—´æˆ³
        timestamp = datetime.now().isoformat()
        
        # è®°å½•çŠ¶æ€æ•°æ®
        log_entry = {
            'timestamp': timestamp,
            'battery': status.get('battery'),
            'temperature': status.get('temperature'),
            'height': status.get('height'),
            'flying': status.get('flying')
        }
        
        # å†™å…¥æ–‡ä»¶
        self.file.write(json.dumps(log_entry) + '\n')
        self.file.flush()
    
    def close(self):
        self.file.close()

# ä½¿ç”¨è®°å½•å™¨
logger = DataLogger('drone_status.log')
await bridge.subscribe_status_updates(logger.status_callback)
```

è¿™ä¸ªå¯è§†åŒ–æŒ‡å—æä¾›äº†WebSocketçŠ¶æ€è®¢é˜…åŠŸèƒ½çš„å…¨é¢è§†å›¾ï¼Œå¸®åŠ©ç†è§£ç³»ç»Ÿçš„å·¥ä½œåŸç†å’Œä½¿ç”¨æ–¹æ³•ã€‚

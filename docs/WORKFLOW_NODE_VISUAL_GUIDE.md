# Tello工作流节点可视化指南

## 节点库结构图

```
┌─────────────────────────────────────────────────────────────────┐
│                      Tello工作流节点库                           │
│                     (41个节点, 11个分类)                         │
└─────────────────────────────────────────────────────────────────┘
                                │
                ┌───────────────┴───────────────┐
                │                               │
        ┌───────▼────────┐            ┌────────▼────────┐
        │  核心节点库     │            │   UI组件        │
        │  (lib/workflow) │            │  (components)   │
        └───────┬────────┘            └────────┬────────┘
                │                               │
    ┌───────────┼───────────┐          ┌───────┴────────┐
    │           │           │          │                │
┌───▼───┐  ┌───▼───┐  ┌───▼───┐  ┌───▼────────┐  ┌───▼─────┐
│定义层 │  │注册层 │  │节点层 │  │节点库组件  │  │图标组件 │
└───────┘  └───────┘  └───────┘  └────────────┘  └─────────┘
```

## 节点分类树

```
工作流节点 (41个)
│
├─ 🟢 流程控制 (2个)
│  ├─ ○ start - 开始
│  └─ ● end - 结束
│
├─ 🔵 基础控制 (5个)
│  ├─ ✈️ takeoff - 起飞
│  ├─ 🛬 land - 降落
│  ├─ ⚠️ emergency_stop - 紧急停止
│  ├─ ⏰ wait - 等待
│  └─ ⏸️ hover - 悬停
│
├─ 🟣 移动控制 (8个)
│  ├─ ⬆️ move_forward - 前进
│  ├─ ⬇️ move_backward - 后退
│  ├─ ⬅️ move_left - 左移
│  ├─ ➡️ move_right - 右移
│  ├─ ⤴️ move_up - 上升
│  ├─ ⤵️ move_down - 下降
│  ├─ 🔄 rotate_cw - 顺时针旋转
│  └─ 🔃 rotate_ccw - 逆时针旋转
│
├─ 🟣 AI分析 (3个) ⭐ 新增
│  ├─ 💬 purechat_chat - PureChat对话
│  ├─ 🧠 purechat_image_analysis - AI图像分析
│  └─ ✂️ unipixel_segmentation - UniPixel分割
│
├─ 🟠 检测任务 (4个)
│  ├─ 👁️ yolo_detection - YOLO检测 ⭐ 新增
│  ├─ 📱 qr_scan - QR码扫描 (增强)
│  ├─ 🍓 strawberry_detection - 草莓检测
│  └─ 🎯 object_tracking - 目标跟踪
│
├─ 🟠 挑战任务 (8个) ⭐ 新增
│  ├─ 🔄 challenge_8_flight - 8字飞行
│  ├─ 🚧 challenge_obstacle - 穿越障碍
│  ├─ 🎯 challenge_precision_land - 精准降落
│  ├─ ⚡ flip_forward - 前翻
│  ├─ ⚡ flip_backward - 后翻
│  ├─ ⚡ flip_left - 左翻
│  └─ ⚡ flip_right - 右翻
│
├─ 🩷 逻辑判断 (3个)
│  ├─ 🔀 condition_branch - 条件分支
│  ├─ 🔀 if_else - IF-ELSE判断
│  └─ 🔁 loop - 循环
│
└─ 🔵 数据处理 (8个)
   ├─ 📝 variable_set - 设置变量
   ├─ 📖 variable_get - 获取变量
   ├─ 🔄 data_transform - 数据转换
   ├─ 🔍 data_filter - 数据过滤
   ├─ 📷 take_photo - 拍照
   ├─ 🎥 start_video - 开始录像
   └─ ⏹️ stop_video - 停止录像
```

## 新增节点详细视图

### 1. PureChat AI节点

```
┌─────────────────────────────────────────────────────────┐
│ 💬 PureChat对话 (purechat_chat)                         │
├─────────────────────────────────────────────────────────┤
│ 参数:                                                    │
│  ├─ 🤖 assistantId      [必填] AI助理ID                 │
│  ├─ 💭 prompt           [必填] 提示词 (1-2000字符)      │
│  ├─ 🌡️ temperature      [可选] 温度 (0-2)               │
│  ├─ 📊 maxTokens        [可选] 最大Token (100-4000)     │
│  └─ 📤 outputVariable   [必填] 输出变量名               │
├─────────────────────────────────────────────────────────┤
│ 用途: 与AI进行智能对话,获取分析建议                      │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 🧠 AI图像分析 (purechat_image_analysis)                 │
├─────────────────────────────────────────────────────────┤
│ 参数:                                                    │
│  ├─ 🤖 assistantId      [必填] AI助理ID                 │
│  ├─ 🖼️ imageSource      [必填] 图像来源                 │
│  │   └─ 选项: camera / upload / variable               │
│  ├─ 💭 prompt           [必填] 分析提示                 │
│  └─ 📤 outputVariable   [必填] 输出变量名               │
├─────────────────────────────────────────────────────────┤
│ 用途: 使用AI分析图像内容,识别对象和场景                  │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ ✂️ UniPixel分割 (unipixel_segmentation)                 │
├─────────────────────────────────────────────────────────┤
│ 参数:                                                    │
│  ├─ 🖼️ imageSource      [必填] 图像来源                 │
│  ├─ 🔍 query            [必填] 分割查询 (1-200字符)     │
│  ├─ 📊 confidence       [可选] 置信度 (0.1-1.0)         │
│  ├─ 🎞️ sampleFrames     [可选] 采样帧数 (1-10)          │
│  ├─ 👁️ visualize        [可选] 可视化结果               │
│  └─ 📤 outputVariable   [必填] 输出变量名               │
├─────────────────────────────────────────────────────────┤
│ 用途: 精确分割图像中的特定对象                           │
└─────────────────────────────────────────────────────────┘
```

### 2. YOLO检测节点

```
┌─────────────────────────────────────────────────────────┐
│ 👁️ YOLO检测 (yolo_detection)                            │
├─────────────────────────────────────────────────────────┤
│ 参数:                                                    │
│  ├─ 🤖 modelSource      [必填] 模型来源                 │
│  │   └─ 选项: builtin / upload / url                   │
│  ├─ 📁 modelPath        [可选] 模型路径                 │
│  ├─ 🖼️ imageSource      [必填] 图像来源                 │
│  ├─ 📊 confidence       [可选] 置信度 (0.1-1.0)         │
│  ├─ 🎯 iouThreshold     [可选] IOU阈值 (0.1-1.0)        │
│  ├─ 🏷️ classes          [可选] 检测类别                 │
│  ├─ 🎨 drawResults      [可选] 绘制结果                 │
│  └─ 📤 outputVariable   [必填] 输出变量名               │
├─────────────────────────────────────────────────────────┤
│ 用途: 使用YOLO模型检测图像中的多个目标对象               │
└─────────────────────────────────────────────────────────┘
```

### 3. 挑战卡任务节点

```
┌─────────────────────────────────────────────────────────┐
│ 🔄 8字飞行 (challenge_8_flight)                         │
├─────────────────────────────────────────────────────────┤
│ 参数:                                                    │
│  ├─ 📏 radius           [必填] 半径 (50-300cm)          │
│  ├─ 🚀 speed            [可选] 速度 (10-100%)           │
│  ├─ 🔁 loops            [可选] 循环次数 (1-5)           │
│  ├─ ⏱️ timeout          [可选] 超时 (10-300秒)          │
│  └─ 🏆 scoreOutput      [可选] 评分变量名               │
├─────────────────────────────────────────────────────────┤
│ 用途: 执行标准8字飞行轨迹,测试飞行精度                   │
│                                                          │
│ 飞行轨迹示意:                                            │
│         ╭─────╮                                          │
│        ╱       ╲                                         │
│       │    ●    │                                        │
│        ╲       ╱                                         │
│         ╰──┬──╯                                          │
│            │                                             │
│         ╭──┴──╮                                          │
│        ╱       ╲                                         │
│       │    ●    │                                        │
│        ╲       ╱                                         │
│         ╰─────╯                                          │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 🚧 穿越障碍 (challenge_obstacle)                         │
├─────────────────────────────────────────────────────────┤
│ 参数:                                                    │
│  ├─ 📍 obstaclePositions [必填] 障碍位置 (JSON)         │
│  ├─ 🚀 speed             [可选] 速度 (10-100%)          │
│  ├─ 🛡️ safetyMargin      [可选] 安全边距 (10-50cm)      │
│  ├─ ⏱️ timeout           [可选] 超时 (30-300秒)         │
│  └─ 🏆 scoreOutput       [可选] 评分变量名              │
├─────────────────────────────────────────────────────────┤
│ 用途: 穿越多个障碍物,测试避障能力                        │
│                                                          │
│ 飞行路径示意:                                            │
│   起点 ──→ 🚧 ──→ 🚧 ──→ 🚧 ──→ 终点                    │
│            ↓      ↓      ↓                              │
│          障碍1  障碍2  障碍3                             │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 🎯 精准降落 (challenge_precision_land)                   │
├─────────────────────────────────────────────────────────┤
│ 参数:                                                    │
│  ├─ 📍 targetPosition   [必填] 目标位置 (JSON)          │
│  ├─ 🎯 precision        [必填] 精度要求 (5-50cm)        │
│  ├─ 🔄 maxAttempts      [可选] 最大尝试 (1-5次)         │
│  ├─ ⏱️ timeout          [可选] 超时 (10-180秒)          │
│  └─ 🏆 scoreOutput      [可选] 评分变量名               │
├─────────────────────────────────────────────────────────┤
│ 用途: 在指定位置精准降落,测试定位精度                     │
│                                                          │
│ 降落示意:                                                │
│         ✈️ (当前位置)                                    │
│          ↓                                              │
│          ↓  调整位置                                     │
│          ↓                                              │
│         🎯 (目标位置)                                    │
│         ±10cm 精度                                       │
└─────────────────────────────────────────────────────────┘
```

## 参数类型图标说明

```
📝 string    - 字符串输入
🔢 number    - 数字输入
✅ boolean   - 布尔开关
📋 select    - 下拉选择
🎚️ slider    - 滑块输入
📄 textarea  - 多行文本
🤖 assistant - AI助理选择
🖼️ image     - 图像选择
📦 json      - JSON编辑
📁 file      - 文件上传
```

## 节点颜色方案

```
🟢 #4ade80  流程控制  ○ start, ● end
🔵 #60a5fa  基础控制  ✈️ takeoff, 🛬 land
🟣 #a78bfa  移动控制  ⬆️ move_*, 🔄 rotate_*
🟡 #fbbf24  旋转控制  🔄 rotate_cw, 🔃 rotate_ccw
🟣 #8b5cf6  AI分析    💬 purechat_*, ✂️ unipixel_*
🟠 #f59e0b  检测任务  👁️ yolo_*, 📱 qr_scan
🟠 #f97316  挑战任务  🔄 challenge_*, ⚡ flip_*
🩷 #ec4899  逻辑判断  🔀 if_else, 🔁 loop
🔵 #6366f1  数据处理  📝 variable_*, 🔄 data_*
🟢 #10b981  图像采集  📷 take_photo, 🎥 video_*
```

## 工作流示例

### 示例1: AI辅助草莓检测工作流

```
┌─────┐     ┌─────┐     ┌──────────┐     ┌─────────┐     ┌─────┐
│ ○   │────→│ ✈️  │────→│ 📷       │────→│ 🧠      │────→│ ●   │
│开始 │     │起飞 │     │拍照      │     │AI分析   │     │结束 │
└─────┘     └─────┘     └──────────┘     └─────────┘     └─────┘
                                                ↓
                                          ┌─────────┐
                                          │ 🍓      │
                                          │草莓检测 │
                                          └─────────┘
```

### 示例2: YOLO检测工作流

```
┌─────┐     ┌─────┐     ┌──────┐     ┌─────────┐     ┌─────┐     ┌─────┐
│ ○   │────→│ ✈️  │────→│ ⬆️   │────→│ 👁️      │────→│ 🛬  │────→│ ●   │
│开始 │     │起飞 │     │前进  │     │YOLO检测 │     │降落 │     │结束 │
└─────┘     └─────┘     └──────┘     └─────────┘     └─────┘     └─────┘
```

### 示例3: 挑战卡任务工作流

```
┌─────┐     ┌─────┐     ┌──────────┐     ┌──────────┐     ┌─────┐     ┌─────┐
│ ○   │────→│ ✈️  │────→│ 🔄       │────→│ 🚧       │────→│ 🎯  │────→│ ●   │
│开始 │     │起飞 │     │8字飞行   │     │穿越障碍  │     │精准 │     │结束 │
│     │     │     │     │          │     │          │     │降落 │     │     │
└─────┘     └─────┘     └──────────┘     └──────────┘     └─────┘     └─────┘
```

## 节点库UI布局

```
┌────────────────────────────────────────────────────────────┐
│ 节点库                                          [搜索框🔍]  │
├────────────────────────────────────────────────────────────┤
│ [全部] [流程] [基础] [移动] [AI] [检测] [挑战] [逻辑]...  │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌──────────────────────────────────────────────┐         │
│  │ 💬 PureChat对话                              │         │
│  │ 使用PureChat AI进行智能对话                  │         │
│  └──────────────────────────────────────────────┘         │
│                                                            │
│  ┌──────────────────────────────────────────────┐         │
│  │ 🧠 AI图像分析                                │         │
│  │ 使用PureChat AI分析图像内容                  │         │
│  └──────────────────────────────────────────────┘         │
│                                                            │
│  ┌──────────────────────────────────────────────┐         │
│  │ ✂️ UniPixel分割                              │         │
│  │ 使用UniPixel进行语义分割                     │         │
│  └──────────────────────────────────────────────┘         │
│                                                            │
│  ┌──────────────────────────────────────────────┐         │
│  │ 👁️ YOLO检测                                  │         │
│  │ 使用YOLO模型进行目标检测                     │         │
│  └──────────────────────────────────────────────┘         │
│                                                            │
├────────────────────────────────────────────────────────────┤
│ 显示 4 个节点                              共 41 个        │
└────────────────────────────────────────────────────────────┘
```

## 快速参考卡片

```
╔═══════════════════════════════════════════════════════════╗
║              Tello工作流节点快速参考                       ║
╠═══════════════════════════════════════════════════════════╣
║ 总节点数: 41个                                            ║
║ 新增节点: 9个 (PureChat×2, UniPixel×1, YOLO×1, 挑战×4)  ║
║ 节点分类: 11个                                            ║
║ 参数类型: 10种                                            ║
║ 验证器: 5个                                               ║
╠═══════════════════════════════════════════════════════════╣
║ 核心文件:                                                 ║
║  • lib/workflow/nodeDefinitions.ts                        ║
║  • lib/workflow/nodeRegistry.ts                           ║
║  • components/workflow/EnhancedNodeLibrary.tsx            ║
╠═══════════════════════════════════════════════════════════╣
║ 使用方法:                                                 ║
║  import { nodeRegistry } from '@/lib/workflow';           ║
║  const nodes = nodeRegistry.getNodesByCategory('ai');     ║
╚═══════════════════════════════════════════════════════════╝
```

---

**提示**: 将鼠标悬停在节点上可查看详细的工具提示信息!

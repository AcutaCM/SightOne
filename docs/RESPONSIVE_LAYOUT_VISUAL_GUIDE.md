# 响应式布局视觉指南

## 布局模式对比

### 桌面布局 (>1024px)

```
┌─────────────────────────────────────────────────────────────────┐
│                         Top Navbar                               │
├──────────────┬──────────────────────────────┬───────────────────┤
│              │                              │                   │
│  Node        │                              │  Control          │
│  Library     │      Workflow Canvas         │  Panel            │
│              │                              │                   │
│  280-500px   │         Flex-1               │  360-600px        │
│              │                              │                   │
│  [Resize]    │  ┌────┐      ┌────┐         │  [Resize]         │
│  Handle      │  │Node│─────▶│Node│         │  Handle           │
│              │  └────┘      └────┘         │                   │
│              │                              │                   │
│  [Collapse]  │  [Zoom] [Minimap]           │  [Collapse]       │
│  Button      │                              │  Button           │
└──────────────┴──────────────────────────────┴───────────────────┘
```

**特点:**
- 标准三栏布局
- 可拖拽调整侧边栏宽度
- 折叠按钮在侧边栏边缘
- 调整手柄可见

---

### 平板布局 (768px - 1024px)

```
┌───────────────────────────────────────────────────────────┐
│                      Top Navbar                            │
├──────────┬────────────────────────────┬───────────────────┤
│          │                            │                   │
│  Node    │                            │  Control          │
│  Library │   Workflow Canvas          │  Panel            │
│          │                            │                   │
│  240px   │      Flex-1                │  300px            │
│  (25vw)  │                            │  (30vw)           │
│          │                            │                   │
│          │  ┌────┐    ┌────┐         │                   │
│          │  │Node│───▶│Node│         │                   │
│          │  └────┘    └────┘         │                   │
│          │                            │                   │
│ [Resize] │  [Zoom]                    │  [Resize]         │
└──────────┴────────────────────────────┴───────────────────┘
```

**特点:**
- 优化的侧边栏宽度 (25% / 30%)
- 仍可拖拽调整
- 按钮尺寸增大 (40px)
- 间距适中

---

### 移动端布局 (<768px)

#### 默认状态 (侧边栏关闭)

```
┌─────────────────────────────────────┐
│          Top Navbar                 │
├─────────────────────────────────────┤
│                                     │
│                                     │
│      Workflow Canvas                │
│                                     │
│      ┌────┐      ┌────┐            │
│      │Node│─────▶│Node│            │
│      └────┘      └────┘            │
│                                     │
│                                     │
│  [☰]                         [⚙]   │
│  浮动按钮                    浮动按钮│
└─────────────────────────────────────┘
```

#### 打开节点库

```
┌─────────────────────────────────────┐
│          Top Navbar                 │
├──────────────┬──────────────────────┤
│              │░░░░░░░░░░░░░░░░░░░░░░│
│  Node        │░░░░░░░░░░░░░░░░░░░░░░│
│  Library     │░░ Canvas (遮罩)  ░░░░│
│              │░░░░░░░░░░░░░░░░░░░░░░│
│  280px       │░░░░░░░░░░░░░░░░░░░░░░│
│  (85vw)      │░░░░░░░░░░░░░░░░░░░░░░│
│              │░░░░░░░░░░░░░░░░░░░░░░│
│  [×]         │░░░░░░░░░░░░░░░░░░░░░░│
│  关闭按钮     │░░░░░░░░░░░░░░░░░░░░░░│
│              │░░░░░░░░░░░░░░░░░░░░░░│
└──────────────┴──────────────────────┘
```

**特点:**
- 抽屉式侧边栏 (从左/右滑入)
- 半透明遮罩层
- 点击遮罩关闭
- 浮动按钮控制
- 全屏画布

---

## 触摸手势

### 双指缩放 (Pinch Zoom)

```
     ┌─────────────────┐
     │                 │
     │    ◄─────►      │  双指捏合/展开
     │   ●     ●       │  缩放范围: 0.5x - 2x
     │                 │
     │   Workflow      │
     │                 │
     └─────────────────┘
```

### 单指拖动 (Pan)

```
     ┌─────────────────┐
     │        ↑        │
     │    ←  ●  →      │  单指拖动
     │        ↓        │  平移画布
     │                 │
     │   Workflow      │
     │                 │
     └─────────────────┘
```

### 双击重置 (Double Tap)

```
     ┌─────────────────┐
     │                 │
     │       ●●        │  快速双击
     │     (tap)       │  重置视图到 1.0x
     │                 │
     │   Workflow      │
     │                 │
     └─────────────────┘
```

---

## 按钮尺寸对比

### 桌面
```
┌──────┐
│  ✕   │  32x48px
│      │  标准尺寸
└──────┘
```

### 平板
```
┌────────┐
│   ✕    │  36x52px
│        │  略大
└────────┘
```

### 移动端
```
┌──────────┐
│    ✕     │  44x56px
│          │  触摸友好
└──────────┘
```

---

## 侧边栏宽度对比

### 节点库

| 设备 | 默认宽度 | 最小宽度 | 最大宽度 |
|-----|---------|---------|---------|
| 桌面 | 280px | 240px | 500px |
| 平板 | 240px (25vw) | 200px | 240px |
| 移动 | 280px (85vw) | - | 320px |

### 控制面板

| 设备 | 默认宽度 | 最小宽度 | 最大宽度 |
|-----|---------|---------|---------|
| 桌面 | 360px | 300px | 600px |
| 平板 | 300px (30vw) | 260px | 300px |
| 移动 | 280px (85vw) | - | 320px |

---

## 动画效果

### 抽屉滑入动画 (移动端)

```
时间轴: 0ms ────────────────────────────────────────────► 300ms

位置:   translateX(-100%)                    translateX(0)
        ┌─────┐                              ┌─────────────┐
        │     │                              │             │
        │     │  ──────────────────────────► │   Visible   │
        │     │                              │             │
        └─────┘                              └─────────────┘
        隐藏                                  完全显示

缓动函数: cubic-bezier(0, 0, 0.2, 1)  // ease-out
```

### 折叠动画 (桌面/平板)

```
时间轴: 0ms ────────────────────────────────────────────► 300ms

宽度:   280px                                48px
        ┌─────────────┐                      ┌┐
        │             │                      ││
        │   Content   │  ──────────────────► ││
        │             │                      ││
        └─────────────┘                      └┘
        展开                                  折叠

透明度: 1.0 ──────────────────────────────► 0.0
        (内容)                               (内容隐藏)

缓动函数: cubic-bezier(0.4, 0, 0.2, 1)  // default
```

### 调整大小动画 (桌面)

```
时间轴: 0ms ────────────────────────────────────────────► 150ms

宽度:   280px                                350px
        ┌─────────────┐                      ┌──────────────────┐
        │             │                      │                  │
        │   Content   │  ──────────────────► │    Content       │
        │             │                      │                  │
        └─────────────┘                      └──────────────────┘
        拖拽前                                拖拽后

缓动函数: cubic-bezier(0.4, 0, 0.2, 1)  // default
```

---

## 响应式断点触发

### 窗口大小变化

```
宽度变化: 1200px ──► 800px ──► 600px

布局模式: Desktop ──► Tablet ──► Mobile
          ┌─┬───┬─┐   ┌┬──┬┐    ┌───┐
          │ │   │ │   ││  ││    │   │
          │ │   │ │   ││  ││    │ ☰ │
          └─┴───┴─┘   └┴──┴┘    └───┘

触发点:   1024px      768px
          ↓           ↓
          切换到平板   切换到移动
```

### 设备旋转

```
竖屏 (Portrait)              横屏 (Landscape)
┌─────────┐                  ┌──────────────────┐
│         │                  │                  │
│         │    旋转 90°      │                  │
│         │  ──────────────► │                  │
│         │                  │                  │
│         │                  └──────────────────┘
└─────────┘

可能触发布局模式切换 (取决于设备尺寸)
```

---

## 触摸目标尺寸

### WCAG 2.1 标准

```
最小触摸目标: 44x44px

┌────────────────┐
│                │
│   ┌────────┐   │  ← 44px
│   │ Button │   │
│   └────────┘   │
│                │
└────────────────┘
     ↑
    44px
```

### 实际应用

```
移动端按钮:
┌──────────────┐
│              │
│   [  确定  ] │  44x44px (最小)
│              │
└──────────────┘

平板按钮:
┌────────────┐
│            │
│  [ 确定 ]  │  40x40px
│            │
└────────────┘

桌面按钮:
┌──────────┐
│          │
│ [ 确定 ] │  36x36px
│          │
└──────────┘
```

---

## 间距系统

### 桌面
```
┌─────────────────────────────┐
│  24px                       │
│  ┌───────────────────────┐  │
│  │                       │  │
│  │      Content          │  │
│  │                       │  │
│  └───────────────────────┘  │
│                       24px  │
└─────────────────────────────┘
```

### 平板
```
┌───────────────────────────┐
│  12px                     │
│  ┌─────────────────────┐  │
│  │                     │  │
│  │    Content          │  │
│  │                     │  │
│  └─────────────────────┘  │
│                     12px  │
└───────────────────────────┘
```

### 移动端
```
┌─────────────────────────┐
│  8px                    │
│  ┌───────────────────┐  │
│  │                   │  │
│  │   Content         │  │
│  │                   │  │
│  └───────────────────┘  │
│                    8px  │
└─────────────────────────┘
```

---

## 性能优化

### CSS Transform vs Position

```
❌ 性能差:
.sidebar {
  left: -280px;  /* 触发 layout */
}

✅ 性能好:
.sidebar {
  transform: translateX(-280px);  /* 只触发 composite */
}
```

### Will-Change 提示

```
.sidebar {
  will-change: transform;  /* 提前告知浏览器 */
}

/* 动画结束后移除 */
.sidebar.static {
  will-change: auto;
}
```

---

## 测试场景

### 场景 1: 桌面 → 移动
```
1. 打开桌面浏览器 (1920x1080)
2. 调整窗口宽度到 600px
3. 验证:
   ✓ 布局切换到移动模式
   ✓ 侧边栏自动折叠
   ✓ 显示浮动按钮
   ✓ 触摸手势启用
```

### 场景 2: 移动端抽屉
```
1. 打开移动设备 (375x667)
2. 点击左侧浮动按钮
3. 验证:
   ✓ 节点库从左侧滑入
   ✓ 显示遮罩层
   ✓ 点击遮罩关闭抽屉
   ✓ 动画流畅 (300ms)
```

### 场景 3: 触摸手势
```
1. 打开移动设备
2. 在画布上双指捏合
3. 验证:
   ✓ 画布缩放 (0.5x - 2x)
   ✓ 缩放中心正确
   ✓ 双击重置到 1.0x
   ✓ 单指拖动平移
```

---

## 常见问题

### Q: 为什么移动端侧边栏是 85vw 而不是固定宽度?
A: 为了适配不同屏幕尺寸,同时确保不会太宽影响可用性。

### Q: 平板模式的断点为什么是 768px?
A: 这是 iPad 竖屏的宽度,也是业界常用的平板断点。

### Q: 触摸手势会影响桌面用户吗?
A: 不会,触摸手势只在检测到触摸设备时启用。

### Q: 如何禁用响应式布局?
A: 可以通过设置固定的 layoutMode 属性来禁用自动检测。

---

## 相关文档

- 📖 [完整实现文档](./RESPONSIVE_LAYOUT_IMPLEMENTATION.md)
- 🚀 [快速入门指南](./RESPONSIVE_LAYOUT_QUICK_START.md)
- 🎨 [设计规范](.kiro/specs/workflow-ui-redesign/design.md)
- ✅ [需求文档](.kiro/specs/workflow-ui-redesign/requirements.md)
